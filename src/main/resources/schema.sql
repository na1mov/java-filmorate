DROP ALL OBJECTS;

CREATE TABLE IF NOT EXISTS rating_mpa (
	rating_mpa_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	name VARCHAR(50)
);

CREATE TABLE IF NOT EXISTS genre (
	genre_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	name VARCHAR(50)
);

CREATE TABLE IF NOT EXISTS users (
	user_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	email VARCHAR(100) NOT NULL,
	login VARCHAR(100) NOT NULL,
	name VARCHAR(100),
	birthday DATE
);

CREATE TABLE IF NOT EXISTS film (
	film_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	name VARCHAR(100) NOT NULL,
	description VARCHAR(200),
	release_date DATE,
	duration INT,
	rating_mpa_id INT REFERENCES rating_mpa (rating_mpa_id)
);

CREATE TABLE IF NOT EXISTS film_genre (
    film_genre_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	film_id INT REFERENCES film (film_id) ON DELETE CASCADE,
	genre_id INT REFERENCES genre (genre_id)
);

CREATE TABLE IF NOT EXISTS film_like (
    film_like_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	film_id INT REFERENCES film (film_id) ON DELETE CASCADE,
	user_id INT REFERENCES users (user_id)
);

CREATE TABLE IF NOT EXISTS friendship (
    friendship_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	user_id INT REFERENCES users (user_id) ON DELETE CASCADE,
	friend_id INT REFERENCES users (user_id) ON DELETE CASCADE
);